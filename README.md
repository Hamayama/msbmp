# msbmp

## 概要
- Gauche で、Windows のビットマップファイル (画像ファイル) を、  
  読み書きするためのモジュールです。  
  ファイルは、24 bit カラーで無圧縮のもののみ読み書き可能です。


## インストール方法
- msbmp.scm を Gauche でロード可能なフォルダにコピーします。  
  (例えば (gauche-site-library-directory) で表示されるフォルダ等)


## 使い方
- 以下を実行します。
  ```
    (use msbmp)
  ```
  以後、本モジュールが使用可能になります。

  使用可能なクラスを以下に示します。
  - `<ms-bitmap-data>`  
    画像データを格納するクラスです。以下のスロットを持ちます。
    - width  
      画像の幅 (px) を格納します。
    - height  
      画像の高さ (px) を格納します。
    - data  
      画像データ (u8vector) を格納します。  
      1ピクセルは、RGBA が各 1 バイトで、合計 4 バイトを占めます。  
      `#u8(R G B A  R G B A  R G B A ...)`

  使用可能な手続きを以下に示します。
  - `(load-ms-bitmap-file file [trans-color])`
    - Windows のビットマップファイルを読み込みます。  
      ファイルは、24 bit カラーで無圧縮のもののみ読み込み可能です。

    - 引数 file には、ファイルのパス名を指定します。

    - オプション引数 trans-color には、  
      透明色を '(R G B) というリストで指定します (各色は 0 - 255 の値) 。  
      引数に #f を指定すると、透明色の指定なしになります。  
      引数省略時は、#f を指定したことになります。

    - 読み込んだ画像データは、戻り値として、  
      `<ms-bitmap-data>` クラスのインスタンスに格納されて返ります。

  - `(save-ms-bitmap-file file img)`
    - Windows のビットマップファイルを書き込みます。  
      ファイルは、24 bit カラーで無圧縮のもののみ書き込み可能です。  
      透明色の情報は失われます。

    - 引数 file には、ファイルのパス名を指定します。

    - 引数 img には、画像データを、  
      `<ms-bitmap-data>` クラスのインスタンスに格納して渡します。


## 使用例
1. サンプルプログラムの sample-bmp.scm を参照ください。  
   (画像ファイルを読み込み、左上の 4 ピクセルだけ変更して書き出すサンプルです)


## 環境等
- OS
  - Windows 10 (version 21H2) (64bit)
- 言語
  - Gauche v0.9.12

## 履歴
- 2023-1-6   v1.00 (初版)


(2023-1-6)
